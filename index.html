<!-- 🌟 BAHAGIAN 1: EKSPLORASI INTERAKTIF KESULTANAN MELAYU 🌟 -->
<section id="eksplorasi">
  <h1>🏰 Eksplorasi Kesultanan Melayu 🏰</h1>
  <p>Klik pada kad untuk mengetahui maklumat ringkas tentang setiap kesultanan.</p>

  <div class="grid-container">
    <div class="card" onclick="showInfo('pahang')">Kesultanan Pahang</div>
    <div class="card" onclick="showInfo('perak')">Kesultanan Perak</div>
    <div class="card" onclick="showInfo('terengganu')">Kesultanan Terengganu</div>
    <div class="card" onclick="showInfo('selangor')">Kesultanan Selangor</div>
  </div>
</section>

<!-- Popup info -->
<div id="popup" class="popup">
  <div class="popup-content">
    <span class="close" onclick="closePopup()">&times;</span>
    <h2 id="popup-title"></h2>
    <p id="popup-text"></p>
  </div>
</div>

<style>
  #eksplorasi {
    margin-top: 20px;
    padding: 30px;
    background: linear-gradient(135deg, #f8bbd0, #a7c7e7);
    border-radius: 20px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    animation: fadeIn 1s ease-in-out;
  }

  .grid-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 25px;
  }

  .card {
    background: #fff;
    padding: 25px;
    border-radius: 20px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    transition: 0.4s;
    cursor: pointer;
    font-weight: bold;
    color: #4a148c;
  }

  .card:hover {
    transform: translateY(-5px) scale(1.05);
    background: #f3e5f5;
    box-shadow: 0 8px 15px rgba(0,0,0,0.2);
  }

  .popup {
    display: none;
    position: fixed;
    z-index: 999;
    left: 0; top: 0;
    width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.6);
    animation: fadeIn 0.5s ease;
  }

  .popup-content {
    background-color: white;
    margin: 10% auto;
    padding: 30px;
    border-radius: 20px;
    width: 85%;
    max-width: 550px;
    text-align: left;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    animation: slideUp 0.5s ease;
  }

  .popup-content h2 {
    color: #4a148c;
    margin-bottom: 15px;
  }

  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }

  .close:hover { color: #000; }

  @keyframes slideUp {
    from { transform: translateY(50px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }
</style>

<script>
  const info = {
    pahang: {
      title: "Kesultanan Pahang",
      text: `
      🌸 <b>Asal usul:</b> Diasaskan oleh Sultan Muhammad Shah pada abad ke-15.<br><br>
      ⚜️ <b>Sistem pemerintahan:</b> Berasaskan sistem feudal; Sultan dibantu oleh pembesar utama seperti Orang Kaya Indera Shahbandar dan Orang Kaya Indera Perba Jelai.<br><br>
      📜 <b>Undang-undang:</b> Hukum Kanun Pahang diadaptasi daripada Hukum Kanun Melaka.<br><br>
      🕌 <b>Ciri penting:</b> Pemerintahan menitikberatkan ajaran Islam dan adat istiadat Melayu.
      `
    },
    perak: {
      title: "Kesultanan Perak",
      text: `
      🌸 <b>Asal usul:</b> Diasaskan oleh Sultan Muzaffar Shah, putera Sultan Mahmud Shah dari Melaka.<br><br>
      ⚜️ <b>Sistem pemerintahan:</b> Sultan dibantu pembesar negeri melalui sistem warisan Kesultanan Melaka.<br><br>
      📜 <b>Undang-undang:</b> Undang-undang 99 Perak diperkenalkan semasa pemerintahan Sultan Iskandar Dzulkarnain.<br><br>
      🕌 <b>Ciri penting:</b> Mengutamakan agama Islam, adat istiadat dan kedaulatan diraja.
      `
    },
    terengganu: {
      title: "Kesultanan Terengganu",
      text: `
      🌸 <b>Asal usul:</b> Ditubuhkan oleh Tun Zainal Abidin I pada tahun 1725.<br><br>
      ⚜️ <b>Sistem pemerintahan:</b> Pemerintahan beraja yang berasaskan Islam dan adat Melayu.<br><br>
      📜 <b>Undang-undang:</b> Dikenali sebagai Undang-undang Bagi Diri Kerajaan Terengganu yang digubal oleh Sultan Zainal Abidin III.<br><br>
      🕌 <b>Ciri penting:</b> Menitikberatkan nilai keagamaan dan tradisi tempatan.
      `
    },
    selangor: {
      title: "Kesultanan Selangor",
      text: `
      🌸 <b>Asal usul:</b> Diasaskan oleh Raja Lumu yang kemudiannya bergelar Sultan Salehuddin Shah pada abad ke-18.<br><br>
      ⚜️ <b>Sistem pemerintahan:</b> Sultan dibantu oleh pembesar negeri dan mengamalkan sistem warisan Melayu Melaka.<br><br>
      📜 <b>Undang-undang:</b> Dipengaruhi oleh adat Melayu dan ajaran Islam.<br><br>
      🕌 <b>Ciri penting:</b> Pemerintahan berteraskan Islam, menjaga keharmonian rakyat serta hubungan baik dengan kerajaan lain.
      `
    }
  };

  function showInfo(state) {
    document.getElementById("popup-title").innerHTML = info[state].title;
    document.getElementById("popup-text").innerHTML = info[state].text;
    document.getElementById("popup").style.display = "block";
  }

  function closePopup() {
    document.getElementById("popup").style.display = "none";
  }
</script>
<!-- 🌟 Bahagian 2: Kuiz Pintar Bab 7 - Kesultanan Melayu 🌟 -->
<section id="kuiz-section" style="display:none; text-align:center; padding:40px;">
  <h2 style="color:#4a148c; font-size:2em;">💎 Kuiz Pintar: Uji Pengetahuan Anda! 💎</h2>
  <p id="score-display" style="font-size:1.2em; color:#6a1b9a; margin-bottom:20px;">Skor semasa: 0</p>
  <div id="quiz-container"></div>
  <p id="result"></p>

  <audio id="correctSound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
  <audio id="wrongSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
  <audio id="cheerSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>

  <style>
    .question {
      background:#ffffffd9;
      border-radius:20px;
      box-shadow:0 5px 12px rgba(0,0,0,0.2);
      padding:25px;
      margin:25px auto;
      width:90%;
      max-width:550px;
      animation:popIn 0.5s ease;
    }
    button {
      margin:8px;
      padding:12px 20px;
      border:none;
      border-radius:10px;
      background-color:#ba68c8;
      color:white;
      cursor:pointer;
      transition:0.3s;
    }
    button:hover {transform:scale(1.07);}
    .correct {background-color:green!important;}
    .wrong {background-color:red!important;}
    .feedback {font-weight:bold;margin-top:10px;}
    .feedback.correct {color:green;}
    .feedback.wrong {color:red;}
    @keyframes popIn {from{transform:scale(0.9);opacity:0;}to{transform:scale(1);opacity:1;}}
    @keyframes confettiFall {0%{transform:translateY(0)rotate(0deg);opacity:1;}100%{transform:translateY(100vh)rotate(720deg);opacity:0;}}
  </style>

  <script>
    const quiz = [
      { question: "1. Siapakah pengasas Kesultanan Selangor?", answers: ["Raja Lumu", "Raja Sakti", "Tun Telanai", "Raja Bahar"], correct: 0 },
      { question: "2. Di manakah pusat pemerintahan awal Kesultanan Perak?", answers: ["Kuala Kangsar", "Lambor Kanan", "Teluk Intan", "Pasir Salak"], correct: 1 },
      { question: "3. Siapakah Sultan Pahang yang memperkenalkan Undang-undang 99 Perak?", answers: ["Sultan Iskandar Dzulkarnain", "Sultan Mahmud", "Sultan Mansur", "Sultan Alauddin"], correct: 0 },
      { question: "4. Apakah nama badan yang memilih Sultan Terengganu?", answers: ["Jumaah Pangkuan Diraja", "Majlis Raja-Raja", "Majlis Negeri", "Majlis Agama"], correct: 0 },
      { question: "5. Siapakah anak angkat Raja Patani yang terkenal?", answers: ["Raja Bahar", "Tun Telanai", "Che Siti Wan Kembang", "Raja Lumu"], correct: 2 }
    ];

    let current = 0, score = 0, userAnswers = [];
    const quizContainer = document.getElementById("quiz-container");
    const scoreDisplay = document.getElementById("score-display");
    const result = document.getElementById("result");

    function startKuiz(){
      document.getElementById("kuiz-section").style.display = "block";
      showQuestion();
    }

    function showQuestion(){
      const q = quiz[current];
      quizContainer.innerHTML = `
        <div class="question">
          <h3>${q.question}</h3>
          ${q.answers.map((a,i)=>`<button onclick="checkAnswer(this,${i})">${a}</button>`).join("")}
          <p>Soalan ${current+1} daripada ${quiz.length}</p>
        </div>`;
    }

    function checkAnswer(btn, i){
      const buttons = btn.parentElement.querySelectorAll("button");
      userAnswers.push(i);
      const feedback = document.createElement("div");
      feedback.classList.add("feedback");

      if(i===quiz[current].correct){
        score++;
        btn.classList.add("correct");
        document.getElementById("correctSound").play();
        feedback.textContent = "✅ Betul! Hebat!";
        feedback.classList.add("correct");
      } else {
        btn.classList.add("wrong");
        buttons[quiz[current].correct].classList.add("correct");
        document.getElementById("wrongSound").play();
        feedback.textContent = "❌ Salah, cuba lagi!";
        feedback.classList.add("wrong");
      }

      btn.parentElement.appendChild(feedback);
      buttons.forEach(b=>b.disabled=true);
      scoreDisplay.textContent = `Skor semasa: ${score}`;
      
      setTimeout(()=>{
        current++;
        if(current < quiz.length) showQuestion();
        else endQuiz();
      },3000);
    }

    function endQuiz(){
      quizContainer.innerHTML = "";
      document.getElementById("cheerSound").play();
      showConfetti();
      let review = `<h3>🎉 Markah akhir: ${score}/${quiz.length}</h3><hr><h4>Semakan Jawapan:</h4>`;
      quiz.forEach((q,i)=>{
        const icon = userAnswers[i]===q.correct ? "✅" : "❌";
        review += `<p><b>${q.question}</b><br>Jawapan anda: ${q.answers[userAnswers[i]]||"—"} ${icon}<br>Jawapan betul: <b>${q.answers[q.correct]}</b></p><hr>`;
      });
      review += `<button onclick="restartQuiz()">Ulang Kuiz 🔁</button>`;
      result.innerHTML = review;
      scoreDisplay.textContent = `Skor akhir: ${score}`;
    }

    function restartQuiz(){
      current=0; score=0; userAnswers=[];
      result.innerHTML="";
      showQuestion();
    }

    function showConfetti(){
      const colors=['#ff0a54','#ff477e','#ff7096','#f7cad0','#fae0e4'];
      for(let i=0;i<100;i++){
        const confetti=document.createElement('div');
        confetti.classList.add('confetti');
        confetti.style.position='fixed';
        confetti.style.width='10px';
        confetti.style.height='10px';
        confetti.style.top='0';
        confetti.style.left=Math.random()*100+'vw';
        confetti.style.backgroundColor=colors[Math.floor(Math.random()*colors.length)];
        confetti.style.animation=`confettiFall ${(Math.random()*2+3)}s linear forwards`;
        document.body.appendChild(confetti);
        setTimeout(()=>confetti.remove(),3500);
      }
    }
  </script>
</section>